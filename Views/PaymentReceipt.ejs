<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Payment Receipt</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
      integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
      crossorigin="anonymous"
    ></script>
    <style>
      * {
        font-family: "Times New Roman", Times, serif;
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      .custom-border {
        border: 0.1px solid black;
      }
      .titles {
        font-weight: bolder;
        font-size: 17px;
        padding: 0;
        margin: 0;
      }
      .subtitles {
        font-weight: 1000;
        font-size: 7px;
        padding: 1;
        margin: 0;
        font-style: italic;
      }
      .section2 {
        font-size: 13px;
      }
      .section3 {
        font-size: 14px;
      }
      .text-size {
        font-size: 10px;
        /* padding-bottom: 0; */
      }
      .issuedtime {
        font-size: 12px;
        margin: 0;
        padding: 0;
        text-align: center;
      }
      @media print {
        @page {
          size: A5;
          margin: 0;
        }
        body {
          margin: 1mm;
        }
      }
    </style>
  </head>
  <body style="width: 540px">
    <div class="receipt mx-3 mt-4 col" style="width: 540px">
      <div
        class="row"
        d-flex
        align-items-center
        justify-content-space-between
      >
        <div class="col-4">
          <img
            src="http://103.27.85.36/Tchveellogo/techveel.jpg"
            alt="Company Logo"
            class="img-fluid py-2 "
            style="object-fit: contain; max-width: 100px"
          />
        </div>
        <div class="col-7 text-right">
          <h6 class="text-right pt-4">Payment Receipt</h6>
        </div>
      </div>

      <% PaymentData.forEach(data => { %>
      <div class="border-top border-dark p-0 m-0">
        <div class="row-3">
          <div class="text-center px-4">
          <p class="titles mt-2">TECHVEEL</p>
          <p class="subtitles">Building Sucessfull Career</p>
          <p class="text-size pb-0 mb-2">
            36, Railway Station border Road, Kodambakkam, Chennai - 600024,
            Tamil Nadu, India, <br />
            GSTIN No: 33APIPM4941D2Z1, Web Site: techveel.com, <br />
            Mobile No: 7397253866, Email: enquiry@techveel.com <br />
          </p>
          </div>
        </div>

        <div class="row-2">
          <div class="row no-gutters">
            <div class="col-6">
              <div
                class="border-top border-bottom border-right px-2 text-md-end"
              >
                <p class="m-0 section2">Receipt No : <%= data.PaymentId %></p>
                <p class="m-0 section2">
                  Receipt Date : <%= new
                  Date(data.PaymentDate).toLocaleDateString('en-IN') %>
                </p>
              </div>
            </div>

            <div class="col-6">
              <div class="border-top border-bottom px-2 text-md-end">
                <p class="m-0 section2">
                  Registration No : <%= data.Admissionid %>
                </p>
                <p class="m-0 section2">
                  Payment Mode :
                  <span style="text-transform: uppercase"
                    ><%= data.PayMode %></span
                  >
                </p>
              </div>
            </div>
          </div>
        </div>

        <div class="border-bottom border-dark">
          <div class="col p-3">
            <div class="row-8">
              <p>
                <b>Received from <span style="padding: 10px">:</span></b> <%=
                data.FirstName %> <%= data.LastName %>
              </p>

              <p>
                <b> For<span style="padding: 10px">:</span> </b><%=
                data.Course_Category %>(<%= data.Course_Name %>) -
                <%=data.Course_Duration %>
              </p>

              <p>
                <b>Course Fee<span style="padding: 10px">:</span> ₹ </b> <%=
                data.CourseFee %>
              </p>

              <p>
                <b> The Sum of <span style="padding: 10px">:</span></b> Rupees
                <%= toWords.convert(data.PaidAmount, {currency: false}) %> Only
              </p>

              <p>
                <b>Paid Amount<span style="padding: 10px">:</span>₹</b> <%=
                data.PaidAmount %>
                <b style="padding-left: 50px"
                  >Payment Type<span style="padding: 10px">:</span></b
                ><%= data.PayType %>
              </p>

              <p>
                <b>Remarks<span style="padding: 10px">:</span></b> <%=
                data.Remarks %>
              </p>

              <div class="mt-5">
                <p class="section2" style="font-weight: 600">
                  ( <span style="font-weight: 600">Note : </span> Payment cannot
                  be refunded for any reason once it is paid )
                </p>
              </div>

              <div class="row mt-4">
                <div class="col-6 text-start">
                  <p class="section3 text-start">Administrator</p>
                  <h5 class="section3 text-start"><b>Prepared by</b></h5>
                </div>
                <div class="col-6 text-end">
                  <p class="section3"><br /></p>
                  <h5 class="section3 text-end pr-3" style="text-align: right">
                    <b>Received by</b>
                  </h5>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <p class="issuedtime">Receipt Issued on: <%= getCurrentDateTime() %></p>
      <% }) %>
    </div>
  </body>
</html>

<% function getCurrentDateTime() {
  const now = new Date();
  const day = String(now.getDate()).padStart(2, '0');
  const month = String(now.getMonth() + 1).padStart(2, '0'); 
  const year = now.getFullYear();
  const hours = String(now.getHours() % 12 || 12).padStart(2, '0');
  const minutes = String(now.getMinutes()).padStart(2, '0');
  const seconds = String(now.getSeconds()).padStart(2, '0');
  const ampm = now.getHours() >= 12 ? 'PM' : 'AM';
  return `${day}/${month}/${year}, ${hours}:${minutes}:${seconds} ${ampm}`;
} 
%>
